# Supabase Schema for The Grand Tour Gamble â€“ Live Game Integration

## Tables Overview

### 1. sessions
- id (UUID, Primary Key)
- title (Text)
- created_at (Timestamp)
- current_stage (Integer)
- is_active (Boolean)
- trainer_id (UUID, FK to users)

### 2. teams
- id (UUID, Primary Key)
- session_id (UUID, FK to sessions)
- name (Text)
- type (Enum: ['rubicon', 'rival'])
- synergy_score (Integer, default: 100)
- total_points (Integer, default: 0)

### 3. cyclists
- id (UUID, Primary Key)
- team_id (UUID, FK to teams)
- name (Text)
- stamina (Integer, default: 10)
- current_points (Integer, default: 0)
- character_role (Enum: ['sprinter', 'climber', 'wildcard', 'teamplayer', 'opportunist'])
- fatigue_penalty (Boolean, default: false)

### 4. users
- id (UUID, Primary Key)
- email (Text)
- team_id (UUID, FK to teams)
- cyclist_id (UUID, FK to cyclists)
- role (Enum: ['player', 'trainer'])
- assigned_code (Text)
- session_id (UUID, FK to sessions)

### 5. decisions_log
- id (UUID, Primary Key)
- cyclist_id (UUID, FK to cyclists)
- session_id (UUID, FK to sessions)
- stage_number (Integer)
- decision (Enum: ['sprint', 'cruise'])
- timestamp (Timestamp)

## Realtime Subscriptions
- `decisions_log`: trigger updates to dashboards
- `teams`: watch synergy/points
- `cyclists`: sync stamina/points per rider